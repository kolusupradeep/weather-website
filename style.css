/* === REALLY FINAL OVERRIDE (placed last) === */
html body .card,
body .container .card,
.card{
  width: 340px !important;
  max-width: 340px !important;
  height: 500px !important;
  max-height: 500px !important;
  transform: none !important;
  margin: 0 auto !important;
  overflow: auto !important;
}
.card:hover{ transform: none !important; }
@media (max-width: 480px){
  html body .card,
  body .container .card,
  .card{
    width: 340px !important;
    max-width: 340px !important;
    height: 500px !important;
    max-height: 500px !important;
    transform: none !important;
  }
}
/* ===== FINAL OVERRIDE: force exact card size and no scaling ===== */
html body .card,
body .container .card,
.card{
  width: 340px !important;
  max-width: 340px !important;
  height: 500px !important;
  max-height: 500px !important;
  transform: none !important;
  overflow: auto !important;
  margin: 0 auto !important;
}

@media (max-width: 480px){
  html body .card,
  body .container .card,
  .card{
    width: 340px !important;
    max-width: 340px !important;
    height: 500px !important;
    max-height: 500px !important;
    transform: none !important;
  }
}
/* ===== Fixed card dimensions (final override) ===== */
.card{
  width: 340px !important;
  max-width: 340px !important;
  height: 500px !important;
  max-height: 500px !important;
  transform: none !important; /* no scaling, exact size */
  margin: 0 auto !important;
  overflow: auto; /* scroll if content exceeds 500px */
}

@media (max-width: 480px){
  .card{
    width: 340px !important;
    max-width: 340px !important;
    height: 500px !important;
    max-height: 500px !important;
    transform: none !important;
  }
}
/* ===== Center layout ===== */
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
}

body {
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(180deg, #c7eaff 0%, #ffffff 100%);
  background-repeat: no-repeat;
  background-size: cover;
  min-height: 100vh;
  overflow: hidden; /* no extra scroll */
}

/* ===== Default card style (for larger screens) ===== */
.card {
  width: clamp(280px, 90vw, 350px);
  max-width: 350px;
  background: linear-gradient(180deg, #5db8fe, #389ff5);
  border-radius: 20px;
  box-shadow: 0 12px 28px rgba(0, 0, 0, 0.15);
  padding: 25px 20px;
  text-align: center;
  color: white;
  transform-origin: center center;
  transform: scale(0.95);
  transition: transform 0.3s ease;
}

/* ===== Hover effect (desktop only) ===== */
@media (hover: hover) {
  .card:hover {
    transform: scale(1);
  }
}

/* ===== Mobile view: reduce size by 40% and center ===== */
@media (max-width: 480px) {
  body {
    align-items: center;
    justify-content: center;
  }

  .card {
    transform: scale(0.6); /* 40% smaller than original */
    transform-origin: center center;
    width: 100%;
    max-width: 340px;
    padding: 16px;
    margin: 0 auto;
  }
}
/* ===== Center page + show background ===== */
html, body {
  height: 100% !important;
  margin: 0 !important;
}
body {
  min-height: 100dvh !important;
  display: grid !important;
  place-items: center !important;       /* vertical + horizontal center */
  padding: 24px !important;             /* breathing room so shadows aren't cut */
  background: linear-gradient(180deg, #c7eaff 0%, #ffffff 100%) !important;
  background-repeat: no-repeat !important;
  background-size: cover !important;
}

/* ===== Normalize the card (single source of truth) ===== */
.card {
  /* Size */
  width: clamp(280px, 90vw, 350px) !important;
  max-width: 350px !important;
  height: auto !important;
  max-height: none !important;          /* stop internal short card */
  overflow: visible !important;         /* no inner scroll */
  
  /* Spacing & look */
  margin: 0 auto !important;
  padding: 24px 20px !important;
  border-radius: 20px !important;
  box-shadow: 0 12px 28px rgba(0,0,0,.15) !important;
  background: linear-gradient(180deg, #5db8fe, #389ff5) !important;
  color: #fff !important;
  text-align: center !important;

  /* Consistent transform */
  transform: scale(0.95) !important;
  transform-origin: center center !important;
  transition: transform .25s ease, box-shadow .25s ease !important;
}

/* Optional hover – keep it subtle and centered */
.card:hover {
  transform: scale(1) !important;
  box-shadow: 0 15px 35px rgba(0,0,0,.2) !important;
}

/* ===== Kill the conflicting rules ===== */
/* These earlier groups were forcing width:100% and the short max-height */
.weather-card, .panel {
  /* keep their look if you use them, but do NOT force full-width or inner scroll */
  width: auto !important;
  max-width: none !important;
  height: auto !important;
  max-height: none !important;
  overflow: visible !important;
}

/* Media queries – keep behavior consistent on phones */
@media (max-width: 480px) {
  .card {
    width: clamp(280px, 92vw, 350px) !important;
    padding: 22px 16px !important;
    transform: scale(0.93) !important;  /* smaller but still centered */
  }
}

/* Neutralize wrappers if they force full-viewport */
.app, .container, .wrapper, .screen, .page, #app, #root {
  min-height: unset !important;
  height: auto !important;
}
*{
    margin: 0;
    padding: 0;
    font-family: 'poppins', sans-serif;
    box-sizing: border-box;
}

/* Prevent any horizontal scroll and visual edge clipping on mobile due to wide animated layers */
html, body{ max-width: 100%; overflow-x: clip; }
/* Fallback for older browsers */
@supports not (overflow-x: clip){ html, body{ overflow-x: hidden; } }

/* ================= Animations Layer ================= */
.anim-layer{
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: 0.5;
}

/* Sunny: rotating glow */
.card[data-anim="sunny"] .anim-layer::before{
  content: "";
  position: absolute;
  width: 220px; height: 220px;
  top: -30px; right: -30px;
  border-radius: 50%;
  background: radial-gradient(circle at 35% 35%, rgba(255,255,255,0.9), rgba(255,255,255,0.1) 60%, transparent 70%);
  box-shadow: 0 0 60px rgba(255,255,200,0.75), 0 0 120px rgba(255,255,200,0.35);
  animation: spin 20s linear infinite;
}

.card[data-anim="sunny"] .anim-layer::after{
  content: "";
  position: absolute;
  width: 260px; height: 260px;
  top: -50px; right: -50px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0.0) 60%);
  box-shadow: inset 0 0 40px rgba(255,255,255,0.15);
  animation: spin 30s linear infinite reverse;
}

.card[data-anim="sunny"] .anim-layer{ opacity: 0.6; }

@keyframes spin { to { transform: rotate(360deg); } }

/* Clouds: drifting bands */
.card[data-anim="clouds"] .anim-layer::before,
.card[data-anim="mist"] .anim-layer::before{
  content: "";
  position: absolute;
  left: -50%; right: -50%;
  top: 20%; height: 80px;
  background: linear-gradient( to right, rgba(255,255,255,0.25), rgba(255,255,255,0.4), rgba(255,255,255,0.25) );
  filter: blur(10px);
  border-radius: 40px;
  animation: drift 22s linear infinite;
}

.card[data-anim="clouds"] .anim-layer::after{
  content: "";
  position: absolute;
  left: -60%; right: -40%;
  top: 55%; height: 70px;
  background: linear-gradient( to right, rgba(255,255,255,0.2), rgba(255,255,255,0.35), rgba(255,255,255,0.2) );
  filter: blur(12px);
  border-radius: 40px;
  animation: drift 28s linear infinite reverse;
}

@keyframes drift { from { transform: translateX(-10%); } to { transform: translateX(10%); } }

/* Rain: falling streaks */
.card[data-anim="rain"] .anim-layer{
  background-image: repeating-linear-gradient(180deg, rgba(255,255,255,0.25) 0px, rgba(255,255,255,0.25) 2px, transparent 3px, transparent 12px);
  background-size: 100% 14px;
  animation: rain-fall 0.45s linear infinite;
  opacity: 0.35;
}

@keyframes rain-fall { from { background-position-y: 0; } to { background-position-y: 14px; } }

/* Snow: gentle dots */
.card[data-anim="snow"] .anim-layer{
  background-image: radial-gradient(circle, rgba(255,255,255,0.8) 0.8px, transparent 1px);
  background-size: 12px 12px;
  animation: snow-fall 2.2s linear infinite;
  opacity: 0.6;
}

@keyframes snow-fall { from { background-position: 0 0; } to { background-position: 0 12px; } }

/* Thunder: occasional flashes */
.card[data-anim="thunder"] .anim-layer::after{
  content: "";
  position: absolute; inset: 0;
  background: radial-gradient(circle at 70% 20%, rgba(255,255,255,0.85), transparent 40%);
  opacity: 0;
  animation: flash 6s linear infinite;
}

@keyframes flash {
  0%, 92%, 100% { opacity: 0; }
  94% { opacity: 0.85; }
  96% { opacity: 0.1; }
}

/* Wind: subtle moving haze */
.card[data-anim="wind"] .anim-layer{
  background: linear-gradient( to right, rgba(255,255,255,0.08), rgba(255,255,255,0.18), rgba(255,255,255,0.08) );
  animation: drift 20s linear infinite;
  filter: blur(6px);
}

/* Base background (softer) */
body {
    min-height: 100dvh;
    height: 100svh; /* ensure full viewport used; stable on mobile */
    margin: 0;
    /* Soft sky gradient background */
    background: linear-gradient(to bottom, #aee1f9, #ffffff);
    background-attachment: fixed;
    display: flex;               /* center layout */
    align-items: center;         /* vertical center */
    justify-content: center;     /* horizontal center */
    padding: 24px;               /* breathing room */
    padding-left: max(24px, env(safe-area-inset-left));
    padding-right: max(24px, env(safe-area-inset-right));
    padding-top: max(24px, env(safe-area-inset-top));
    padding-bottom: max(24px, env(safe-area-inset-bottom));
}

/* Use small viewport units on mobile to avoid Safari URL bar jump */
@supports (height: 100svh){
  body{ min-height: 100svh; }
}

/* Weather-driven themes */
body.sunny {
  background: linear-gradient(180deg, #FFE082 0%, #FFB74D 45%, #81D4FA 100%);
}

body.cloudy {
  background: linear-gradient(180deg, #C5CAE9 0%, #B0BEC5 100%);
}

body.rainy {
  background: linear-gradient(180deg, #90A4AE 0%, #607D8B 100%);
}

body.night {
  background: radial-gradient(1200px 600px at 50% -200px, #1B263B 0%, #0D1B2A 70%);
}

body.fog {
  background: linear-gradient(180deg, #ECEFF1 0%, #CFD8DC 100%);
}

/* subtle noise overlay */
body::after {
  content: "";
  position: fixed; inset: 0;
  pointer-events: none;
  opacity: .05;
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="60" height="60"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency=".9" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity=".5"/></svg>');
  mix-blend-mode: overlay;
}

/* (demo-note removed to restore original homepage UI) */

.card{
    width: clamp(260px, 90vw, 350px);
    max-width: 350px;
    /* Light-to-deeper blue gradient inside the card */
    background: linear-gradient(180deg, #5db8fe, #389ff5);
    color: #fff;
    margin: 0 auto;
    border-radius: 20px;
    padding: 28px 22px;
    text-align: center;
    /* Elevated shadow */
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.18);
    filter: brightness(1.02);
    border: 1px solid rgba(255,255,255,.25);
    position: relative; /* for animation layer */
    z-index: 2; /* keep above background stage */
    overflow: hidden;
    transform-origin: top center;
    transition: transform .22s ease;
    /* Ensure the card never overflows screen height; allow internal scrolling if needed */
    max-height: calc(100svh - 48px);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
}

/* Weather theme variants applied from JS */
.card.theme-clear { background: linear-gradient(135deg, #56CCF2, #2F80ED); }
.card.theme-clouds { background: linear-gradient(135deg, #757F9A, #D7DDE8); }
.card.theme-rain, .card.theme-drizzle { background: linear-gradient(135deg, #00C6FB, #005BEA); }
.card.theme-mist { background: linear-gradient(135deg, #606c88, #3f4c6b); }
.card.theme-snow { background: linear-gradient(135deg, #E0EAFC, #CFDEF3); color:#0d1b2a; }

.search {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
    z-index: 1;
    gap: 10px;
    margin-bottom: 14px; /* give breathing room above results */
    flex-wrap: nowrap; /* keep input and button on one row */
}

.search input {
    border: 0;
    outline: 0;
    color: #555;
    padding: 10px 25px;
    height: 60px;
    border-radius: 30px;
    flex: 1 1 auto;
    margin-right: 16px;
    font-size: 18px;
    text-align: center; /* center placeholder */
    transition: box-shadow 0.2s ease, transform 0.15s ease;
    background: #ffffff;
    box-shadow: 0 6px 16px rgba(0,0,0,0.12);
    min-width: 0; /* allow shrinking on narrow devices */
}

.search input::placeholder{ color: rgba(0,0,0,0.45); font-size: 16px; }

.search input:focus{
    text-align: left; /* when typing, align left */
    box-shadow: 0 0 0 4px rgba(47,128,237,0.15);
    transform: scale(1.02);
}

.search button{
    border: 0;
    outline: 0;
    background: #ebfffc;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    flex: 0 0 auto; /* prevent shrink on narrow screens */
    cursor: pointer;
    transition: background 0.15s ease;
}

.search button img{
    width: 16px;
}

/* Suggestions dropdown */
.suggestions{
    display: none;
    width: 100%;
    margin-top: 10px;
    text-align: left;
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 14px;
    overflow: hidden;
    box-shadow: 0px 6px 16px rgba(0,0,0,0.25);
    backdrop-filter: blur(6px);
    color: #fff;
    max-height: 260px;
    overflow-y: auto;
}

.suggestion-item{
    padding: 12px 16px;
    cursor: pointer;
    transition: background 0.15s ease;
}

.suggestion-item:hover,
.suggestion-item.active{
    background: rgba(0, 0, 0, 0.18);
}

.weather-icon{
    width: clamp(120px, 18vw, 170px);
    margin-top: 30px;
}

/* Sunny icon glow for extra clarity */
.card.theme-clear .weather-icon{
  filter: drop-shadow(0 6px 18px rgba(255,215,0,0.4));
}

.weather h1{
    font-size: clamp(42px, 6vw, 80px);
    font-weight: 700; /* bolder for emphasis */
}

.weather h2{
    font-size: clamp(22px, 4.2vw, 45px);
    font-weight: 300; /* lighter city name */
    margin-top: -10px;
}

.details{
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
    margin-top: 50px;
}

.col{
    display: flex;
    align-items: center;
    text-align: left;
}

.col img{
    width: 44px; /* consistent, cleaner */
    margin-right: 10px;
    background: rgba(255,255,255,0.12);
    padding: 6px;
    border-radius: 10px;
    filter: drop-shadow(0 2px 6px rgba(0,0,0,0.18));
}

.humidity, .wind{
    font-size: clamp(22px, 3.8vw, 28px);
    margin-top: -6px;
}

.weather{
    display: none;
    position: relative;
    z-index: 1;
    margin-top: 18px; /* push weather block down a bit by default */
    /* Responsive scale only for the displayed weather block */
    width: clamp(220px, 28vw, 280px);
    margin-left: auto;
    margin-right: auto;
}

.error{
    text-align: left;
    margin-left: 10px;
    font-size: 14px;
    margin-top: 10px;
    display: none;
}

/* Responsive: mobile-first tweaks */

.toolbar{
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 10px;
  margin-bottom: 10px;
  position: relative;
  z-index: 1;
}

/* Subtle pulse hint on empty state */
.card.is-empty .btn-search{
  position: relative;
}
.card.is-empty .btn-search::after{
  content: "";
  position: absolute;
  inset: -6px;
  border-radius: 50%;
  box-shadow: 0 0 0 0 rgba(255,255,255,0.45);
  animation: pulseRing 1.8s ease-out infinite;
}

@keyframes pulseRing{
  0% { box-shadow: 0 0 0 0 rgba(255,255,255,0.45); }
  70% { box-shadow: 0 0 0 16px rgba(255,255,255,0.0); }
  100% { box-shadow: 0 0 0 0 rgba(255,255,255,0.0); }
}

.unit-toggle{
  display: inline-flex;
  gap: 0;
  background: rgba(255,255,255,0.16);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 999px;
  overflow: hidden;
}

.unit-toggle .unit-opt{
  appearance: none;
  border: 0;
  background: transparent;
  color: #fff;
  padding: 8px 14px;
  font-size: 14px;
  cursor: pointer;
}

.unit-toggle .unit-opt.active{
  background: rgba(0,0,0,0.28);
}

.btn-geo{
  border: 1px solid rgba(255,255,255,0.3);
  background: rgba(255,255,255,0.12);
  color: #fff;
  padding: 8px 12px;
  border-radius: 10px;
  font-size: 13px;
  cursor: pointer;
  transition: background 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
}

.btn-geo.active{
  background: rgba(0,0,0,0.75);
  border-color: rgba(255,255,255,0.8);
  box-shadow: inset 0 0 0 2px rgba(255,255,255,0.3);
}

.btn-geo:disabled{
  opacity: 0.6;
  cursor: not-allowed;
}

.btn-geo:focus-visible{
  outline: none;
  box-shadow: 0 0 0 3px rgba(47,128,237,0.4);
}

/* ===== Weather Stage (new background system) ===== */
#weather-stage{ position: fixed; inset: 0; z-index: 0; pointer-events: none; }
#weather-stage canvas,
#weather-stage .overlay,
#weather-stage .clouds{ position: absolute; inset: 0; }
/* layer order: clouds below rain/snow, sun and flashes above */
#weather-stage .clouds{ z-index: 1; top: 0; bottom: auto; height: 40vh; }
#weather-stage canvas{ z-index: 2; }
#weather-stage .fog{ z-index: 2; }
#weather-stage .sunbeams{ z-index: 3; }
#weather-stage .sun{ z-index: 4; }
#weather-stage .flash{ z-index: 5; }

/* clouds container */
#weather-stage .clouds{ overflow: visible; opacity: 0.85; filter: drop-shadow(0 2px 6px rgba(0,0,0,.35)); }

/* Prevent any child from causing horizontal scroll on mobile */
#weather-stage, #weather-stage *{
  max-width: 100vw !important;
  overflow-x: hidden !important;
}

/* individual cloud puffs (override generic .cloud) */
#weather-stage .cloud{
  position: absolute;
  top: var(--top, 10%);
  left: -40%;
  width: var(--w, 480px);
  height: calc(var(--w, 480px) * 0.5);
  background:
    radial-gradient(ellipse at 30% 50%, #fff 0%, #e9eef7 60%, rgba(255,255,255,0) 70%),
    radial-gradient(ellipse at 60% 60%, #fff 0%, #e9eef7 60%, rgba(255,255,255,0) 70%),
    radial-gradient(ellipse at 45% 40%, #fff 0%, #e9eef7 60%, rgba(255,255,255,0) 70%);
  border-radius: 50%/60%;
  mix-blend-mode: screen;
  animation: drift var(--speed, 60s) linear infinite;
  will-change: transform;
}

@keyframes drift{ from{ transform: translateX(0); } to { transform: translateX(120vw); } }

/* overlays */
#weather-stage .fog{
  background:
    radial-gradient(circle at 20% 20%, rgba(255,255,255,.06), transparent 40%),
    radial-gradient(circle at 80% 30%, rgba(255,255,255,.05), transparent 45%),
    radial-gradient(circle at 50% 70%, rgba(255,255,255,.07), transparent 50%);
  animation: fogmove 30s ease-in-out infinite alternate;
  filter: blur(2px);
  opacity: 0;
  transition: opacity .8s ease;
}

@keyframes fogmove{ from { transform: translate3d(-2%,0,0) } to { transform: translate3d(2%,0,0) } }

#weather-stage .flash{
  background: radial-gradient(circle at 50% 50%, rgba(255,255,255,.9), rgba(255,255,255,0) 60%);
  opacity: 0;
  transition: opacity .08s linear;
  mix-blend-mode: screen;
}

#weather-stage .sunbeams{
  background:
    conic-gradient(from 0deg at 80% -10%,
      rgba(255,255,200,.18), rgba(255,255,200,0) 18%,
      rgba(255,255,200,.18) 20%, rgba(255,255,200,0) 38%,
      rgba(255,255,200,.18) 40%, rgba(255,255,200,0) 58%,
      rgba(255,255,200,.18) 60%, rgba(255,255,200,0) 78%,
      rgba(255,255,200,.18) 80%, rgba(255,255,200,0) 100%);
  opacity: 0;
  animation: beams 8s linear infinite;
  transform: translateZ(0);
}

@keyframes beams{ from{ transform: rotate(0deg); } to { transform: rotate(360deg); } }

/* Sun disk (top-right) */
#weather-stage .sun{
  position: absolute;
  top: 4vh;
  right: 6vw;
  width: clamp(120px, 18vw, 200px);
  height: clamp(120px, 18vw, 200px);
  border-radius: 50%;
  /* If images/sun.png exists it will show on top; gradient is fallback */
  background:
    url('images/sun.png') center/contain no-repeat,
    radial-gradient(circle at 40% 40%, #fffbe6 0 38%, #ffd36b 39% 68%, rgba(255,211,107,0) 69%),
    radial-gradient(circle at center, rgba(255,211,107,.55), rgba(255,211,107,0) 70%);
  box-shadow:
    0 0 80px 16px rgba(255,208,103,.45),
    0 0 140px 24px rgba(255,230,150,.28);
  opacity: 0;
  transition: opacity .6s ease;
}

/* Cloud polish (top band look) */
#weather-stage .clouds{ filter: drop-shadow(0 6px 18px rgba(0,0,0,.18)); }
#weather-stage .cloud{
  filter: blur(.3px) saturate(1.02);
}

/* ===== Tiny test UI (non-intrusive) ===== */
.dbg-toggle{
  position: fixed; bottom: 16px; right: 16px;
  width: 36px; height: 36px; border-radius: 50%;
  border: 1px solid rgba(255,255,255,.5);
  background: rgba(0,0,0,.35);
  color: #ffd36b; font-size: 16px; line-height: 1;
  display: inline-flex; align-items: center; justify-content: center;
  cursor: pointer; z-index: 20;
  backdrop-filter: blur(6px) saturate(120%);
  box-shadow: 0 6px 20px rgba(0,0,0,.25);
}
.dbg-toggle:hover{ background: rgba(0,0,0,.45); }
.dbg-toggle:focus-visible{ outline: none; box-shadow: 0 0 0 3px rgba(255,211,107,.4); }

.dbg-menu{
  position: fixed; bottom: 60px; right: 16px;
  background: rgba(20,24,32,.9);
  color: #fff; border: 1px solid rgba(255,255,255,.2);
  border-radius: 10px; padding: 10px;
  display: grid; grid-auto-rows: auto; gap: 6px; min-width: 160px;
  z-index: 20; backdrop-filter: blur(8px) saturate(120%);
  box-shadow: 0 10px 30px rgba(0,0,0,.35);
}
.dbg-menu button{
  background: rgba(255,255,255,.08);
  border: 1px solid rgba(255,255,255,.18);
  color: #fff; padding: 6px 8px; border-radius: 8px;
  cursor: pointer; text-align: left; font: inherit;
}
.dbg-menu button:hover{ background: rgba(255,255,255,.14); }
.dbg-menu hr{ border: none; height: 1px; background: rgba(255,255,255,.2); margin: 4px 0; }

/* ===== Dynamic Background (behind everything) ===== */
.bg{ position: fixed; inset: 0; z-index: 0; pointer-events: none; transition: background 300ms ease; }
.bg.day{ background: linear-gradient(180deg,#9bd4ff 0%, #7cc8ff 50%, #ffe08a 100%); animation: skyShift 22s ease-in-out infinite alternate; }

/* Sunny */
.bg.sunny{ background: linear-gradient(180deg,#9bd4ff 0%, #7cc8ff 50%, #ffe08a 100%); }
.bg.sunny .sun{
  position:absolute; width:240px; height:240px; border-radius:50%; left:50%; top:11vh; transform:translateX(-50%);
  background:
    radial-gradient(circle at 40% 40%, #fffbe6 0 35%, #ffd36b 36% 65%, rgba(255,211,107,0) 66%),
    radial-gradient(circle at center, rgba(255,211,107,.55), rgba(255,211,107,0) 70%);
  box-shadow: 0 0 80px 12px rgba(255,208,103,.55);
  animation: sunFloat 10s ease-in-out infinite;
}
.bg.sunny .rays{
  position:absolute; width:420px; height:420px; border-radius:50%; left:50%; top:2.5vh; transform:translateX(-50%);
  background: conic-gradient(from 0deg, rgba(255,216,121,.28) 0 10deg, transparent 10deg 20deg);
  -webkit-mask: radial-gradient(circle 130px at center, transparent 125px, black 130px);
          mask: radial-gradient(circle 130px at center, transparent 125px, black 130px);
  animation: raysSpin 60s linear infinite; opacity:.35; filter: blur(.2px);
}

/* Cloudy */
.bg.cloudy{ background: linear-gradient(180deg,#cfd8e3 0%, #b0bec5 100%); }
.bg.cloudy .clouds, .bg.rainy .clouds{ position:absolute; inset:0; overflow:hidden; }
.cloud{ position:absolute; width:140%; height:160px; left:-20%;
  background:
    radial-gradient(120px 70px at 8% 60%, #fff 0 60%, transparent 61%),
    radial-gradient(140px 80px at 18% 50%, #ffffff 0 60%, transparent 61%),
    radial-gradient(160px 90px at 32% 52%, #ffffff 0 60%, transparent 61%),
    radial-gradient(120px 70px at 46% 58%, #fff 0 60%, transparent 61%),
    radial-gradient(150px 85px at 60% 55%, #fff 0 60%, transparent 61%),
    radial-gradient(120px 70px at 74% 58%, #fff 0 60%, transparent 61%),
    radial-gradient(140px 80px at 88% 50%, #fff 0 60%, transparent 61%);
  opacity:.75; filter:blur(.5px);
}
.cloud.band1{ top:18vh; animation: cloudDrift 90s linear infinite; }
.cloud.band2{ top:34vh; opacity:.6; animation: cloudDrift 120s linear infinite reverse; transform:scale(1.1); }

/* Rainy */
.bg.rainy{ background: linear-gradient(180deg,#90a4ae 0%, #607d8b 100%); }
.bg.rainy .rain{ position:absolute; inset:0; background-image: linear-gradient(180deg, rgba(255,255,255,.65), rgba(255,255,255,0) 60%);
  background-size: 2px 18px; -webkit-mask: repeating-linear-gradient(90deg, #000 0 16px, transparent 16px 24px); mask: repeating-linear-gradient(90deg, #000 0 16px, transparent 16px 24px);
  opacity:.25; animation: rainFall .9s linear infinite; }

/* Snowy */
.bg.snowy{ background: linear-gradient(180deg,#cfe9ff 0%, #9ec6e6 100%); }
.bg.snowy .snow{ position:absolute; inset:0;
  background-image:
    radial-gradient(2px 2px at 10% 20%, rgba(255,255,255,.9) 99%, transparent 100%),
    radial-gradient(2px 2px at 30% 80%, rgba(255,255,255,.9) 99%, transparent 100%),
    radial-gradient(3px 3px at 50% 10%, rgba(255,255,255,.9) 99%, transparent 100%),
    radial-gradient(2px 2px at 70% 60%, rgba(255,255,255,.9) 99%, transparent 100%),
    radial-gradient(3px 3px at 90% 30%, rgba(255,255,255,.9) 99%, transparent 100%);
  background-size:100% 100%; animation: snowFall 10s linear infinite; opacity:.9; }

/* Night */
.bg.night{ background: radial-gradient(900px 500px at 50% -150px, #24324a 0%, #0d1b2a 60%); }
.bg.night .stars{ position:absolute; inset:0; background-image:
    radial-gradient(1px 1px at 20% 30%, rgba(255,255,255,.8) 99%, transparent 100%),
    radial-gradient(1px 1px at 40% 60%, rgba(255,255,255,.8) 99%, transparent 100%),
    radial-gradient(1.5px 1.5px at 60% 20%, rgba(255,255,255,.8) 99%, transparent 100%),
    radial-gradient(1px 1px at 80% 70%, rgba(255,255,255,.8) 99%, transparent 100%),
    radial-gradient(1px 1px at 30% 80%, rgba(255,255,255,.8) 99%, transparent 100%);
  opacity:.8; animation: starDrift 180s linear infinite; }

/* Keyframes */
@keyframes skyShift { 0%{background-position:0 0; filter:saturate(105%)} 100%{background-position:0 20%; filter:saturate(120%)} }
@keyframes sunFloat { 0%,100%{ transform:translate(-50%,0) } 50%{ transform:translate(-50%,8px) } }
@keyframes raysSpin { to { transform:translateX(-50%) rotate(360deg) } }
@keyframes cloudDrift { from{transform:translateX(0)} to{transform:translateX(-20%)} }
@keyframes rainFall { from{background-position:0 -18px} to{background-position:0 0} }
@keyframes snowFall { from{transform:translateY(-10px)} to{transform:translateY(10px)} }
@keyframes starDrift { from{background-position:0 0} to{background-position:-2000px 1000px} }

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){ .bg, .bg *{ animation:none !important; } }

@media (max-width: 480px){
  body{ padding: 8px; }
  .card{
    width: 100%;
    max-width: 440px;
    margin: 0 auto;
    padding: 20px 16px;
    /* remove scale to avoid blur/clipping on phones */
    transform: none;
    overflow-x: hidden;
    overflow-y: auto;
  }
  .toolbar{ gap: 8px; flex-wrap: wrap; justify-content: space-between; }
  .unit-toggle{ transform: scale(.95); }
  .btn-geo{ font-size: 12px; padding: 6px 10px; }
  .search{ gap: 8px; margin-bottom: 24px; }
  .search input{ height: 50px; font-size: 16px; padding: 10px 16px; margin-right: 0; }
  .search button{ width: 50px; height: 50px; }
  .weather-icon{ width: 140px; margin-top: 16px; }
  .weather h1{ font-size: 48px; }
  .weather h2{ font-size: 24px; margin-top: -6px; }
  .weather{ margin-top: 32px; }
  .details{ padding: 0 6px; margin-top: 22px; gap: 16px; flex-direction: column; }
  .col img{ width: 38px; }
  .humidity, .wind{ font-size: 24px; }
  .test-wrap{ margin-top: 10px; }
  .btn-test{ font-size: 13px; padding: 9px 14px; }
}

/* Tablet and small laptop tuning */
@media (max-width: 768px){
  body{ padding: 18px; }
  .card{ width: 92vw; padding: 28px 24px; }
  .toolbar{ gap: 10px; flex-wrap: wrap; }
  .search input{ height: 56px; font-size: 17px; }
  .search button{ width: 56px; height: 56px; }
  .weather h1{ font-size: 68px; }
  .weather h2{ font-size: 34px; }
}

/* Very small phones (e.g., 320–360px width) */
@media (max-width: 380px){
  .card{ width: 100%; max-width: 420px; padding: 16px 12px; border-radius: 16px; transform: none; }
  .toolbar{ gap: 6px; }
  .unit-toggle .unit-opt{ padding: 6px 10px; font-size: 12px; }
  .btn-geo{ font-size: 11px; padding: 6px 8px; }
  .search{ gap: 6px; margin-bottom: 26px; }
  .search input{ height: 46px; font-size: 16px; border-radius: 24px; margin-right: 0; }
  .search button{ width: 46px; height: 46px; }
  .weather-icon{ width: 120px; }
  .weather h1{ font-size: 42px; }
  .weather h2{ font-size: 22px; }
  .weather{ margin-top: 36px; }
  .col img{ width: 34px; padding: 5px; }
  .humidity, .wind{ font-size: 22px; }
}

/* iOS Safari tap highlight and text size adjustment */
* { -webkit-tap-highlight-color: rgba(0,0,0,0); }
html { -webkit-text-size-adjust: 100%; }

/* ===== Centered test button (below card) ===== */
.test-wrap{
  display: none; /* shown by JS after successful fetch */
  width: 100%;
  margin: 14px 0 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2;
}

.btn-test{
  appearance: none;
  border: 1px solid rgba(255,255,255,0.35);
  background: linear-gradient(180deg, rgba(255,255,255,0.16), rgba(255,255,255,0.08));
  color: #fff;
  padding: 10px 16px;
  border-radius: 12px;
  font-size: 14px;
  cursor: pointer;
  backdrop-filter: blur(8px) saturate(120%);
  box-shadow: 0 8px 24px rgba(0,0,0,0.25);
  transition: transform .12s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;
  display: inline-flex; /* ensures margin auto centers precisely */
  margin-left: auto;
  margin-right: auto;
}
.btn-test:hover{
  border-color: rgba(255,255,255,0.6);
  background: linear-gradient(180deg, rgba(255,255,255,0.22), rgba(255,255,255,0.10));
  box-shadow: 0 10px 28px rgba(0,0,0,0.3);
}
.btn-test:active{ transform: translateY(1px); }
.btn-test:focus-visible{ outline: none; box-shadow: 0 0 0 3px rgba(47,128,237,0.35); }

/* ----- HARD RESET & BACKGROUND ----- */
html, body {
  margin: 0 !important;
  padding: 0 !important;
  height: 100% !important;             /* ensure background can paint full page */
}

body {
  min-height: 100dvh !important;       /* mobile-safe viewport height */
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  background: linear-gradient(180deg, #aee1f9 0%, #ffffff 100%) !important;
  background-attachment: fixed !important;  /* keeps gradient visible on scroll */
  background-repeat: no-repeat !important;
  background-size: cover !important;
  overflow: auto !important;            /* allow page to scroll if content is tall */
}

/* ----- CONTAINERS THAT MAY BE FULL-SCREEN ----- */
/* cover common names your layout might use; add yours if different */
.app, .container, .wrapper, .screen, .page, #app, #root {
  width: 100% !important;
  max-width: 340px !important;          /* align with desired card width */
  margin: 24px auto !important;         /* center + breathing room */
  background: transparent !important;   /* let the page background show */
  box-sizing: border-box !important;
}

/* if your main UI card has a solid background, keep it but not full-screen */
.weather-card, .card, .panel {
  width: 100% !important;
  max-width: 340px !important;
  border-radius: 20px !important;
  box-shadow: 0 12px 28px rgba(0,0,0,.15) !important;
  padding: 20px !important;
  margin: 0 auto !important;
  background: linear-gradient(180deg, #5db8fe, #389ff5) !important;
  /* do not force transform here to allow hover effects elsewhere */
}

/* prevent rogue full-viewport rules from taking over */
.app, .container, .wrapper, .screen, .page, .weather-card, .card, .panel {
  height: auto !important;
  min-height: unset !important;
  max-height: none !important;
}

/* responsive tweak */
/* (removed empty media query) */

/* Centering and background */
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
}

body {
  min-height: 100dvh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(180deg, #aee1f9 0%, #ffffff 100%);
  background-attachment: fixed;
  background-repeat: no-repeat;
  background-size: cover;
  overflow: auto;
}

/* Ensure main wrapper centers content vertically too */
.container{
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
}

/* Card base and hover effect for balanced scale on desktop */
.card{
  transform: scale(0.95);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.card:hover{
  transform: scale(1);
  box-shadow: 0 15px 35px rgba(0,0,0,0.2);
}

/* Smaller phones */
@media (max-width: 400px){
  .card{ transform: scale(0.9); padding: 20px 15px; }
}

/* ===== ABSOLUTE LAST OVERRIDE (appended at end) ===== */
/* Home (default) state: flexible card sizing */
.card.is-empty{
  width: clamp(280px, 92vw, 350px) !important;
  max-width: 350px !important;
  height: auto !important;
  max-height: none !important;
  overflow: visible !important;
  transform: none !important;
}

/* Displayed weather only: base size 340x600 and scale to fit viewport on mobile */
html body .card:not(.is-empty),
body .container .card:not(.is-empty),
.card:not(.is-empty){
width: 340px !important;
max-width: 340px !important;
height: 600px !important;
max-height: 600px !important;
margin: 0 auto !important;
overflow: auto !important; /* allow internal scroll if content exceeds */
transform: none !important;
}
.card:not(.is-empty):hover{ transform: none !important; }